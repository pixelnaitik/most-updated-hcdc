!function(){"use strict";const t={initialized:!1,stateStack:[],init:function(){this.initialized||(this.pushState(),window.addEventListener("popstate",this.handleBackButton.bind(this)),this.initialized=!0,console.log("[BackHandler] Initialized successfully"))},pushState:function(t=null){const e=t||{backHandler:!0,timestamp:Date.now()};history.pushState(e,"",location.href)},registerState:function(t,e){this.stateStack=this.stateStack.filter(e=>e.id!==t),this.stateStack.push({id:t,closeHandler:e}),this.pushState({uiState:t})},unregisterState:function(t){this.stateStack=this.stateStack.filter(e=>e.id!==t)},handleBackButton:function(t){if(this.closeActiveModal())this.pushState();else if(this.closeMobileMenu())this.pushState();else{if(this.stateStack.length>0){const t=this.stateStack.pop();if(t&&"function"==typeof t.closeHandler)return t.closeHandler(),void this.pushState()}this.scrollToTop(),this.pushState()}},closeActiveModal:function(){const t=document.getElementById("bookingModal");if(t&&t.classList.contains("active"))return t.classList.remove("active"),document.body.style.overflow="",console.log("[BackHandler] Closed booking modal"),!0;const e=document.getElementById("testDetailModal");if(e&&e.classList.contains("active"))return e.classList.remove("active"),document.body.style.overflow="",console.log("[BackHandler] Closed test detail modal"),!0;const o=document.getElementById("packageDetailModal");if(o&&o.classList.contains("active"))return o.classList.remove("active"),document.body.style.overflow="",console.log("[BackHandler] Closed package detail modal"),!0;const n=document.querySelectorAll(".detail-modal.active");if(n.length>0)return n.forEach(t=>t.classList.remove("active")),document.body.style.overflow="",console.log("[BackHandler] Closed detail modal(s)"),!0;const l=document.querySelector(".modal-overlay.active");return!!l&&(l.classList.remove("active"),document.body.style.overflow="",console.log("[BackHandler] Closed modal overlay"),!0)},closeMobileMenu:function(){const t=document.getElementById("mobileMenuBtn"),e=document.getElementById("navMenu");return!(!t||!t.classList.contains("active"))&&(t.classList.remove("active"),e&&e.classList.remove("active"),document.body.style.overflow="",console.log("[BackHandler] Closed mobile menu"),!0)},scrollToTop:function(){const t=document.getElementById("main-content"),e=document.getElementById("home");e?(e.scrollIntoView({behavior:"smooth",block:"start"}),console.log("[BackHandler] Scrolled to hero section")):t?(t.scrollIntoView({behavior:"smooth",block:"start"}),console.log("[BackHandler] Scrolled to main content")):(window.scrollTo({top:0,behavior:"smooth"}),console.log("[BackHandler] Scrolled to top"))},hasActiveOverlay:function(){if(document.querySelectorAll(".detail-modal.active, .modal-overlay.active, #bookingModal.active").length>0)return!0;const t=document.getElementById("mobileMenuBtn");return!(!t||!t.classList.contains("active"))||this.stateStack.length>0}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){t.init()}):t.init(),window.addEventListener("pageshow",function(e){e.persisted&&(t.pushState(),console.log("[BackHandler] Restored from bfcache"))}),window.BackHandler=t}();